<b>Команды</b>:<br>
<pre>
% cbsd jcoldmigrate
</pre>

<b>Описание</b>:
<br><br>
<b>cbsd jcoldmigrate</b> выполняет холодную (с отстановкой) миграцию клетки с одной ноды на другую.
Параметр <b>node</b> указывает, на какую ноду следует мигрировать клетку. Предварительно, RSA/DSA ключ
удаленной ноды должнен быть добавлен через команду <b>cbsd node mode=add</b>, а также, на удаленной ноде 
должен работать сервис rsyncd <b>cbsdrsync</b>.
<br><br>
По-умолчанию, статус клетки на новой ноде наследуется - если клетка работала, она также будет
автоматически запущена на новой ноде. Если клетка не работала - останется в статусе Off.
Управлять, какой статус должен быть на удаленной клетке не зависимо от состояния на оригинале, можно
через параметр <b>start</b>.
<br><br>
Клетка на первоисточние, после успешного выполнения <b>jcoldmigrate</b> останавливается и переводится
в статус <b>Slave</b>. В rc.conf файле клетки на новой ноде остается запись, с какой именно ноды
этот jail был мигрирован.
<br><br>
Примечание: миграция происходит в следующие этапы (в процессе выполния, они проходят автоматически и не видны)<br><br>
<li>перенос конфигурационных файлов на удаленную ноду, статус клетки - Slave (<b>cbsd j2prepare</b>)
<li>запуск rsync, которая делает полную копию каталога с данными на удаленной ноду (<b>cbsd j2slave</b>)
<li>останов клетки (<b>cbsd j2slave</b>)
<li>повторный запус rsync, которая должна отработать быстрее первого раза за счет того, меньшее кол-во файлов успело модифицироваться
<li>перевод клетки на локальной ноде в статус Slave (<b>cbsd jswmode</b>)
<li>перевод клетки на удаленной ноде в статус Master (<b>cbsd rexe + jswmode</b>)
<li>если клетка была запущена - запуск клетки на удаленной ноде (<b>cbsd rexe + cbsd jstart</b>)
<br><br>
<b>Пример</b> (выполнить холодную миграцию на ноду netsnap):
<pre>
% cbsd jcoldmigrate node=netsnap jname=amp123
<br>
<center>
<i>на сервере netsnap ничего нет:</i>
<img src="/html/img/jcoldmigrate1.png"></img>
<br>
<i>с сервера cbuilder64 мигрируем клетку amp123 на netsnap:</i>
<img src="/html/img/jcoldmigrate2.png"></img>
<br>
<i>клетка amp123 на netsnap запущена автоматически:</i>
<img src="/html/img/jcoldmigrate3.png"></img>
</center>
</p>
