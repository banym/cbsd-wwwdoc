<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
	<META http-equiv="content-type" content="text/html; charset=UTF-8">
	<META name="Description" content="jail management">
	<META name="Keywords" content="jail management">
	<LINK rel="shortcut icon" href="favicon.ico">
	<style type="text/css">
		*{margin:0;padding:0;border:0;font:normal normal 13px/16px arial;}
		html,body{min-height:100%;height:100%;}
		body{background:#fff repeat-x 0 126px url(/html/img/line.gif);}
		a{color:#33c;text-decoration:none;border-bottom:1px solid #66f;}
		a.email{color:#933;}
		a:hover{border-bottom-color:#f66;}
		#wrp{width:800px;margin:0 auto;}
		#lng{height:130px;}
		#cnt{padding-bottom:40px;}
		h2{margin-bottom:10px;font-size:18px;line-height:20px;font-weight:normal;color:#400;}
		p{margin-bottom:10px;text-indent:40px;}
		li{margin:0 0 10px 40px;}
		.block{margin-bottom:20px;}
	</style>
	<TITLE>CBSD - FreeBSD jails management tools</TITLE>
</HEAD>
<BODY>
	<!--# include file="/html/cbsdmenu_ru.html" -->
	<div id="cnt">
		<div class="block">
			<h2>О&nbsp;проекте</h2>
			<p><strong>CBSD</strong> - это обертка из <strong>sh</strong>-скриптов (преимущественно) вокруг подсистемы <a href="http://www.freebsd.org/cgi/man.cgi?query=jail&apropos=0&sektion=0&manpath=FreeBSD+9.1-RELEASE&arch=default&format=html">jail(8)</a> операционной системы <a href="http://www.freebsd.org">FreeBSD</a>, ориентированного на связывании различных особенностей FreeBSD, таких как racct,vnet, zfs, carp, hastd и тд в один инструмент для более комплексного решения при построении серверов приложений, использующее заранее подготовленные jail образы с типовым набором ПО и требующие минимальной настройки.</p>
			<p>Благодаря простоте базового функционала по созданию и удалению клеток (и я надеюсь, он таким и останется), в данный момент существует множество реализаций и надстроек над стандартным jail(8), позволяя людям создавать и использовать собственное варианты по управлению клетками FreeBSD, и CBSD является одним из таких надстроек.</p>
			<p>Какого-либо нового функционала в ОС на данном этапе не внесено - все, что могут делать скрипты <strong>cbsd</strong>, можно сделать командой (командами, десятками, сотнями команд) в CLI через соответствующие утилиты. Проект делается как для облегчения собственных нужд по администрированию клеток и серверов, так и 'just for fun'.</p>
			<p>Из списка собственных нужд можно отметить следующие действа:</p>
			<ul>
				<li>быстрое развертывание jail с нуля</li>
				<li>эспорт и импорт jail в файл</li>
				<li>клонирование и/или миграция jail (в т.ч. на удаленную машину)</li>
				<li>снапшоты jail</li>
				<li>подсчет трафика и потребляемых ресурсов на один jail</li>
				<li>управление ресурсами jail (приоретизация(re-nice), RACCT/RCTL, файловые квоты)</li>
				<li>репликация jail на удаленные машины</li>
				<li>дистрибьюция "типовых" jail, клеток с определенным набором софта и сервисами</li>
				<li>WEB интерфейс и централизованное управление фермой jail-ов</li>
				<li>...</li>
			</ul>
		</div>
		<div class="block">
			<h2>Пара ПОЧЕМУ&hellip;</h2>
			<p>Почему FreeBSD, почему Jail, почему sh, почему ...":</p>
			<ul>
				<li>FreeBSD/jail выбраны для проекта по ряду причин, наиболее важные из которых:</li>
				<li>отсутствие у Jail накладных ресурсов на виртуализацию. Без VIMAGE, код jail до сих пор имеет в ядре крайне мало своих if/case конструкций;</li>
				<li>следование совету безопасников - "разделяй и властвуй". Желательно каждый сервис или группу сервисов изолировать от других;</li>
				<li>Системным инженерам зачастую приходится делать массу однотипных инсталляций - AMP, MTA, KDE4, .. в какой-то момент захотелось иметь заранее сформированное и настроенное окружение. Клеточный подход позволяет ввести сервер в экслуатацию мгновенно, после установки FreeBSD с нуля - для того, чтобы развернуть почтовый сервер или запустить KDE4, никаких настроек в мастер хосте делать не нужно - достаточно скачать заранее сформированное окружение по сети. Возможность создавать Desktop клетки имеют свою особую прелесть в виде остутствии в необходимости создавать 1024-ый по счету дистрибутив, отличающийся от других только картинкой рабочего стола и набором ПО;</li>
				<li>Удобство бекапа и раскатывания клетки на свежеустановленную ноду;</li>
				<li>Построение собственных локальный репозиториев/библиотек клеток с кастомизированными опциями через <a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/ports.html">FreeBSD ports</a>;</li>
				<li>При вышеупомянутом плюсе - отсутствии оверхеда на виртуализацию,  с соответствующим мониторингом, можно формировать максимально эффективные системы. Например, имеются клетки с NoSQL (Redis, Memcached) - плотная работа с памятью, клетка с MySQL - плотная работа с CPU, клетка с WEB-скриптами (CPU&сеть), клетка с Samba (нагрузка на сеть и диски).. Каждую физическую ноду можно укомплектовать такими Jail, с которыми не будет простаивать ни один из аппаратных компонент сервера и при этом, клетки не будут друг другу мешать.</li>
				<li>Мне не очень приятно жить в мире, в котором есть один только Linux ;-)</li>
				<li>...</li>
			</ul>
			<p>Большая часть кода написана на&nbsp;<strong>sh</strong>&nbsp;по&nbsp;той причине, что подобные задачи не&nbsp;требуют большой математической логики&nbsp;&mdash; скрипты в&nbsp;основном повторяют ввод команд системного администратора в&nbsp;консоли, т.е., работают с&nbsp;внешними утилитами, такими как: zfs, zpool, sudo, pkg, rsync, соответственно, необходимость применять языки программирования по&nbsp;большей части отсутствует. Часть узких мест, а&nbsp;также некоторый функционал (logtail, репликация, демон следящий за&nbsp;нодами и&nbsp;тп) написаны на&nbsp;C (в&nbsp;планах переписывать узкие места на&nbsp;Си и&nbsp;дальше).</p>
			<p>cbsd зависит от&nbsp;следующего&nbsp;ПО: <strong>rsync</strong>, <strong>sudo</strong>, <strong>libssh2</strong>, <strong>sqlite3</strong></p>
		</div>
		<div class="block">
			<h2>Особенности&hellip;</h2>
			<ul>
				<li>готовый репозиторий для ядер и&nbsp;миров, что делает шаги buildworld/installworld необязательными.</li>
				<li>Если шаги buildworld/installworld предпринимаются, поддерживается src.conf для кастомизации мира</li>
				<li>base каталог может располагаться на&nbsp;MD/RAM/TMPFS диске, что может быть полезно при большом кол-ве jail-ов с&nbsp;RO-подмонтированной базой</li>
				<li>поддержка ZFS файловой системы, ZFS квот, ZFS снапшотов</li>
				<li>GUI конфигуратор клеток (DIALOG/WEB)</li>
				<li>поддержка VIMAGE</li>
				<li>подсчет трафика в&nbsp;jail</li>
				<li>импортирование/экспортирование клеток</li>
				<li>описания клеток</li>
				<li>холодная миграция клетки с&nbsp;ноды на&nbsp;ноду</li>
				<li>управление очередностью запуска jail и&nbsp;их&nbsp;приоритетом</li>
				<li>поддержка RACCT/RCTL</li>
				<li>репозиторий с&nbsp;готовыми template-клетками</li>
				<li>репликация клетки</li>
				<li>возможность создавать свои собственные сценарии для создания клеток</li>
				<li>конвертирование jail в&nbsp;PXE/ISO/Memstick-имидж</li>
				<li>Поддержка ненативных архитектур клеток через Qemu User mode (например, клетки arm и&nbsp;mips64 архитектуры на&nbsp;x86-64&nbsp;ноде)</li>
				<li>&hellip;</li>
			</ul>
		</div>
		<div class="block">
			<h2>Цели проекта</h2>
			<ul>
				<li>автоматизация типовых операций</li>
				<li>удобный менеджмент, мониторинг и&nbsp;контроль клеток</li>
				<li>создание платформы для приложений по-требованию.</li>
				<li>библиотека образов</li>
				<li>и&nbsp;не&nbsp;только&hellip;</li>
			</ul>
		</div>
	</div>
</BODY>
</HTML>
