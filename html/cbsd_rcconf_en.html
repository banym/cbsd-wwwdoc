<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META http-equiv="content-type" content="text/html; charset=UTF-8">
<LINK rel="shortcut icon" href="favicon.ico">
<title>CBSD&nbsp;&mdash; FreeBSD jails management tools</title>
<meta name="keywords" content="jail ip alias, jail zfs, jail interface, jail baserw, jail mount ports, jail auto start, jail vnet, jail vimage, jail resolv.conf, jail cpuset, jail setfib"/>
<meta name="description" content="jail ip alias, jail zfs, jail interface, jail baserw, jail mount ports, jail auto start, jail vnet, jail vimage, jail resolv.conf, jail cpuset, jail setfib" />
</HEAD>
<!--# include file="/html/cbsdmenu_en.html" -->
<!--# include file="/html/translate_en.html" -->
<body>
<!--# include file="/html/currentver_en.html" -->
<center><FONT face="verdana,arial,helvetica" size="+1">jail settings</font></center>
<FONT face="verdana,arial,helvetica" size="-1">
<br><br>
<body>
<p>Each jail of&nbsp;cbsd has its own settings which is&nbsp;used for starting and stopping the jail.
<br><br>
Some of&nbsp;them are specified during the creation of&nbsp;jail, the rest you can change via the command
<pre>% cbsd jconfig jname=jname</pre>
Only few options at&nbsp;this point can be&nbsp;changed on-the-fly.
<br><br>
This page contains a&nbsp;summary of&nbsp;the default settings and description.
<hr>
<pre>
jname="jail1";
</pre>
Immediately, the unique name of&nbsp;the jail. This is&nbsp;the name that can be&nbsp;seen on&nbsp;the <b>cbsd jls</b> command or&nbsp;in&nbsp;the inventory list of&nbsp;nodes.
This field can not be&nbsp;changed manually. If&nbsp;you want to&nbsp;change the name of&nbsp;the jail please use <b>cbsd jrename</b> command, because the name of&nbsp;the jail
used in&nbsp;many other settings and on&nbsp;the file system directory naming
<hr>
<pre>
path="/usr/jails/jails/jail1";
</pre>
Indicates the path that will be&nbsp;used as&nbsp;the root at&nbsp;the start of&nbsp;the jail. The above configuration is&nbsp;characteristic of&nbsp;jails
who are setting baserw to&nbsp;0 (no&nbsp;write access in&nbsp;base), ie, the base of&nbsp;which is&nbsp;mounted in&nbsp;read-only.
In&nbsp;this case, the algorithm will work jstart follows:
<br>
<br>1) mount a&nbsp;base via nullfs specific version (see below) to&nbsp;/usr/jails/jails/$jname directory
<br>2) on&nbsp;the mounted base at&nbsp;$workdir/jails/jails/$jname mount directories related directly to&nbsp;the jail data (in&nbsp;the directory $workdir/jails-data/$jname), usually in&nbsp;write access
<br>3) start jail with the root $workdir/jails/jails/$jname
<br>
<br>If&nbsp;baserw=1, then nullfs not use and the jail immediately starts with the directory $workdir/jails-data/$jname as&nbsp;root. In&nbsp;these cases, the path is&nbsp;usually seen as&nbsp;a
<br>
<br>path=&quot;/usr/jails/jails-data/jail1-data&quot;;
<hr>
<pre>
host_hostname="jail1.my.domain";
</pre>

FQDN, the full name of&nbsp;the jail. This field can not be&nbsp;changed manually. If&nbsp;you want to&nbsp;change the name of&nbsp;the jail please use <b>cbsd jrename</b> command
<hr>
<pre>
ip4_addr="10.0.0.5/24";
</pre>

IP&nbsp;address of&nbsp;the jail. If&nbsp;you plan to&nbsp;use multiple&nbsp;IP addresses, they are separated by&nbsp;commas:

ip4_addr=&quot;10.0.0.5/24,192.168.0.2/30,54:04:a6:b2:11:c4/64&laquo;;
<hr>
<pre>
mount_devfs="1";
</pre>

Mount a&nbsp;devfs file system into the jail (directory /dev). Most services without this simply can not work.
<hr>
<pre>
allow_mount="1";
</pre>

Allow users or&nbsp;services mount other file system inside the jail
<hr>
<pre>
allow_devfs="0";
</pre>

Allow users or&nbsp;services mount devfs file system inside the jail
<hr>
<pre>
allow_nullfs="0";
</pre>

Allow users or&nbsp;services mount nullfs file system inside the jail
<hr>
<pre>
mount_fstab="/usr/jails/jails-fstab/fstab.jail1";
</pre>

The path to&nbsp;a&nbsp;file containing a&nbsp;list of&nbsp;directories or&nbsp;file systems to&nbsp;be&nbsp;mounted with the jail when it&nbsp;is&nbsp;run
<hr>
<pre>
arch="amd64";
</pre>

Jail architecture (and respectively base from the $workdir/basejail)
<hr>
<pre>
mkhostsfile="1";
</pre>
Whether correct in&nbsp;jail /etc/hosts entry 
<br>$ip4_add $jname $jname.my.domain
<br>
in&nbsp;accordance with the&nbsp;IP address and the name (FQDN) of&nbsp;jail
<hr>
<pre>
devfs_ruleset="4";
</pre>
a&nbsp;set of&nbsp;rules devfs, which will be&nbsp;applied to&nbsp;the devfs file system in&nbsp;the /dev of&nbsp;jail (list of&nbsp;rules in&nbsp;the file /etc/devfs.rules of&nbsp;master node)
<hr>
<pre>
interface="auto";
</pre>
This recording controls the behavior of&nbsp;the automatic creation and deletion of&nbsp;IP addresses on&nbsp;the interface or&nbsp;use the previously established .
<br>
<br>The value <b>auto</b> means that cbsd will select the interface on&nbsp;which to&nbsp;create an&nbsp;IP address jail.
<br>For example : there is&nbsp;a&nbsp;node with two interfaces . 
<br>At&nbsp;the interface igb0 set&nbsp;IP subnet 10.0.0.2/24 and while the default gateway for the server is&nbsp;10.0.0.1, in&nbsp;consequence of&nbsp;which igb0&nbsp;a network card, through which the traffic by&nbsp;default. at&nbsp;the interface
igb1 registered IP/subnet 192.168.0.1/24. 
<br>If&nbsp;the jail in&nbsp;rc.conf ip4_addr takes value 192.168.0.{1-255}, then cbsd automatically selects 
igb1 interface for&nbsp;IP jail. 
<br>If&nbsp;none of&nbsp;the interface is&nbsp;not the subnet that contains the&nbsp;IP jail will be&nbsp;selected by&nbsp;default interface .
<br>
<br>Also, the value can be&nbsp;set to&nbsp;the name of&nbsp;the interface, if&nbsp;you do&nbsp;not want to&nbsp;search for a&nbsp;suitable interface. For example record
<br>
<br>interface = &laquo;igb0&raquo;
<br>
<br>sets the&nbsp;IP address of&nbsp;the jail at&nbsp;the interface igb0.
<br>
<br>As&nbsp;well as&nbsp;during start-up, when cbsd will sets the necessary&nbsp;IP for jail on&nbsp;interface, when you stop them cbsd unset IPs from the interface automatically. Therefore, be&nbsp;extremely careful -
If&nbsp;you set by&nbsp;mistake&nbsp;IP address of&nbsp;the node for jail , then, during the cbsd jstop sequence, cbsd execute
<br>
<br>ifconfig <iface> <ip> -alias
<br>
<br>and a&nbsp;node will be&nbsp;lost in&nbsp;the network.
<br>
<br>To&nbsp;the stop of&nbsp;management&nbsp;IP address, the interface= param can be&nbsp;commented out or&nbsp;removed, or&nbsp;the value is&nbsp;left blank:
<br>
<br>interface=&quot;&quot;
<br>
<br>In&nbsp;this case , cbsd will immediately start the jail with the appropriate&nbsp;IP, meaning that he&nbsp;has already been initialized . Such a&nbsp;situation may be&nbsp;necessary when
server has only one&nbsp;IP address, and you plan to&nbsp;run jail ( or&nbsp;a&nbsp;few jails ) in&nbsp;one existing&nbsp;IP, but with the services within that do&nbsp;not conflict
the ports.
<br>For example, having one&nbsp;IP address , you can start jail with WEB server on&nbsp;port 80 , another jail with the mail server on&nbsp;port 25&nbsp;and so&nbsp;on.
<hr>
<pre>
ver="10.0";
</pre>
Version of&nbsp;the base for jail. Is&nbsp;directly related to&nbsp;the version of&nbsp;FreeBSD. Thus, if&nbsp;the jail are have in&nbsp;rc.conf options
<br>
<br>arch=&quot;amd64&Prime;
<br>ver=&quot;10.0&Prime;
<br>baserw=0
<br>
<br>then at&nbsp;the start of&nbsp;the jail ${workdir}/basejail/base_amd64_10.0 will be&nbsp;selected
<br>
<br>When
<br>
<br>arch=&quot;i386&Prime;
<br>ver=&quot;9.1&Prime;
<br>baserw=0
<br>
<br>it&nbsp;will accordingly be&nbsp;used ${workdir}/basejail/base_i386_9.1.
<br>
<br>This way you can switch the version of&nbsp;base from one version to&nbsp;another
<br>
<br>When baserw=1 means that the entire base has been initialized and is&nbsp;filled from ${workdir}/jails-data/$jname-data, so&nbsp;that these parameters do&nbsp;not matter
<hr>
<pre>
basename="";
</pre>
The base name. You can create a&nbsp;customized base, for example to&nbsp;build a&nbsp;minimal environment and place it&nbsp;to
<br>$workdir/base_lite_amd64_9.2
<br>
<br>To&nbsp;specify cbsd that you need to&nbsp;mount this directory, basename must have &laquo;lite&raquo; prefix:
<br>
<br>basename=&quot;lite&quot;;
<hr>
<pre>
baserw="0";
</pre>
When&nbsp;1, it&nbsp;is&nbsp;understood that a&nbsp;jail has its own base file system and has an&nbsp;entry.
<br>Typically, this parameter is&nbsp;set during the creation of&nbsp;the jail. If&nbsp;you originally created the jail with baserw=0 (readonly), but want to
switch it&nbsp;into a&nbsp;baserw=1&nbsp;mode, you first need to&nbsp;copy all the files from the base directory to&nbsp;$workdir/jails-data/$jname-data. For example:
<br>
<br>cd&nbsp;/usr/jails/basejail/base_amd64_10/
<br>pax -p eme -X -rw . /usr/jails/jails-data/jail1-data
<br>
<br>or, if&nbsp;you have in&nbsp;the master node object files:
<br>make -C /usr/src installworld DESTDIR=&quot;/usr/jails/jails-data/jail1-data&quot;
<br>
<br>In&nbsp;the same way, at&nbsp;this stage, it&nbsp;is&nbsp;supposed to&nbsp;update the jail that operate in&nbsp;baserw=1, since each cell has a&nbsp;personal copy of&nbsp;the base.
<br>In&nbsp;contrast, when using baserw=0, you can only use one copy of&nbsp;the base, which is&nbsp;mounted through nullfs in&nbsp;read-only to&nbsp;all jails.
<br>You can have one base (eg&nbsp;the minimum amount called lite) for a&nbsp;few tens of&nbsp;jails which is&nbsp;placed on&nbsp;md-ramfs to&nbsp;accelerate the operation of&nbsp;the basic tools in&nbsp;the jails.
<br>
<br>In&nbsp;addition, with baserw=0 you have the opportunity to&nbsp;update the version of&nbsp;the base less.
<br>
<br>In&nbsp;addition, the base is&nbsp;mounted in&nbsp;read-only mode gives you extra security if&nbsp;your jail hacked and somebody try to&nbsp;modify the file system&nbsp;&mdash; this is&nbsp;simply will not work.
<hr>
<pre>
mount_src="0";
</pre>
Does the mount /usr/src directory of&nbsp;jail FreeBSD source code in&nbsp;read-only, if&nbsp;they have
<hr>
<pre>
mount_obj="";
</pre>
Does the mount /usr/obj directory of&nbsp;jail FreeBSD source code in&nbsp;read-only, if&nbsp;they have
<hr>
<pre>
mount_kernel="0";
</pre>
Does the mount /boot/kernel kernel FreeBSD. This can be&nbsp;useful, for example, for CTF-information required to&nbsp;operate DTRACE.
<hr>
<pre>
mount_ports="1";
</pre>
Does the mount /usr/ports of&nbsp;the master node in&nbsp;readonly to&nbsp;/usr/ports in&nbsp;jail. 
<br>You can have one copy of&nbsp;ports tree on&nbsp;the master node that is&nbsp;deployed in&nbsp;/usr/ports, and which mount to&nbsp;all jails.
<br>In&nbsp;order to&nbsp;simultaneously compilation of&nbsp;the same port are not conflicted in&nbsp;two or&nbsp;more jails, in&nbsp;the /etc/make.conf option WRKDIRPREFIX must be&nbsp;sets to&nbsp;for alternate location, such as&nbsp;/tmp (if&nbsp;the jail
has applytpl=1&nbsp;settings, this is&nbsp;done automatically)
<hr>
<pre>
astart="1";
</pre>
Whether to&nbsp;start jail automatically when nodes is&nbsp;started. If&nbsp;astart=0, the jail does not run itself on&nbsp;booted node.
<hr>
<pre>
vnet="0";
</pre>
<hr>
<pre>
applytpl="1";
</pre>
Whether to&nbsp;apply some modification in&nbsp;the jail configuration: sets pkg.conf, make entries in&nbsp;the /etc/hosts, and so&nbsp;on.
<hr>
<pre>
mdsize="0";
</pre>
<hr>
<pre>
rcconf="/usr/jails/jails-rcconf/rc.conf_jail1";
</pre>
<hr>
<pre>
floatresolv="1";
</pre>
Automatically correct the /etc/resolv.conf, automatically assigning as&nbsp;the primary nameserver caching named in&nbsp;the master node, the other nameserver&nbsp;&mdash; from inventory of&nbsp;nodes.
<hr>
<pre>
exec_start="/bin/sh /etc/rc";
</pre>
<hr>
<pre>
exec_stop="/bin/sh /etc/rc.shutdown";
</pre>
<hr>
<pre>
exec_poststart="";
</pre>
Execute the command inside the cell jail its launch. You can have multiple scripts are numbered options:
<br>
<br>exec_poststart0=&quot;date &gt; /tmp/start1.txt&quot;;
<br>exec_poststart1=&quot;date &gt; /tmp/start2.txt&quot;;
<br>..
<hr>
<pre>
exec_poststop="";
</pre>
Execute the command inside the jail after a&nbsp;stop. You can have multiple scripts are numbered options:
<br>
<br>exec_poststop0=&quot;date &gt; /tmp/stop1.txt&quot;;
<br>exec_poststop1=&quot;date &gt; /tmp/stop2.txt&quot;;
<br>..
<hr>
<pre>
exec_prestart="";
</pre>
Execute the command inside the jail before its launch. You can have multiple scripts are numbered options:
<br>
<br>exec_prestart0=&quot;date &gt; /tmp/prestart1.txt&quot;;
<br>exec_prestart1=&quot;date &gt; /tmp/prestart2.txt&quot;;
<br>..
<hr>
<pre>
exec_prestop="";
</pre>
Execute the command inside the jail before stop&nbsp;it. You can have multiple scripts are numbered options:
<br>
<br>exec_prestop0=&quot;date &gt; /tmp/prestop1.txt&quot;;
<br>exec_prestop1=&quot;date &gt; /tmp/prestop2.txt&quot;;
<br>..
<hr>
<pre>
exec_master_poststart="";
</pre>
A&nbsp;similar behavior exec_poststart, except that the command is&nbsp;executed in&nbsp;the master system (be&nbsp;careful, its not secure)
<hr>
<pre>
exec_master_poststop="";
</pre>
A&nbsp;similar behavior exec_poststop, except that the command is&nbsp;executed in&nbsp;the master system (be&nbsp;careful, its not secure)
<hr>
<pre>
exec_master_prestart="";
</pre>
A&nbsp;similar behavior exec_prestart, except that the command is&nbsp;executed in&nbsp;the master system (be&nbsp;careful, its not secure)
<hr>
<pre>
exec_master_prestop="";
</pre>
A&nbsp;similar behavior exec_prestop, except that the command is&nbsp;executed in&nbsp;the master system (be&nbsp;careful, its not secure)
<hr>
<pre>
cpuset="0";
</pre>
Assign jail and its processes to&nbsp;specific cores CPU. 
A&nbsp;value of&nbsp;0 (default) means that there is&nbsp;no&nbsp;binding to&nbsp;CPUs and processes will take up&nbsp;all the available cores.
Nonzero value identifies the kernel or&nbsp;a&nbsp;list of&nbsp;the CPUs allowed to&nbsp;work jail. 
Entry must match an&nbsp;entry form for <i>-l cpu-list</i> from <a href="http://www.freebsd.org/cgi/man.cgi?query=cpuset&apropos=0&sektion=0&manpath=FreeBSD+9.2-RELEASE&arch=default&format=html"><b>cpuset(1)</b></a> command, for example:
<pre>
cpuset="1";
</pre>
means that the processes will only run on&nbsp;first core
<pre>
cpuset="0-3"
</pre>
means that the processes will only run on&nbsp;0,1,2,3&nbsp;CPUs
<pre>
cpuset="0,3"
</pre>
means that the process will only run on&nbsp;0&nbsp;and 3&nbsp;CPUs
<br>
This functionality is&nbsp;useful, for example, for profiling software, or&nbsp;if&nbsp;you want to&nbsp;restrict jails by&nbsp;CPUs.
<hr>
<pre>
setfib="0";
</pre>
Assign jail and its processes to&nbsp;separate routing table. A&nbsp;value of&nbsp;0 (default) means that there is&nbsp;no&nbsp;binding and will be&nbsp;use default routing table.
To&nbsp;use <b>setfib</b>, in&nbsp;the file /boot/loader.conf you need to&nbsp;set limits number of&nbsp;tables by&nbsp;parameter <b>net.fibs</b>. 
For example, if&nbsp;you want use five separate routing tables, in&nbsp;/boot/loader.conf you must have the following entry:
<pre>
net.fibs="5"
</pre>
<hr>
<pre>
exec.consolelog="0";
</pre>
Regulates logging output of&nbsp;jail(8) at&nbsp;the start and stop of&nbsp;the jail. By&nbsp;default, the value is&nbsp;<b>0</b>.
<br>
Possible values are:
<br><br>
<b>0</b>&nbsp;&mdash; disable exec.consolelog. In&nbsp;this case, on&nbsp;jstart/jstop will show all output for jail start and jail stop procedures.
<br>
<b>1</b>&nbsp;&mdash; Enable logging to&nbsp;file <i>${workdir}/var/log/${jname}.log</i>, where $jname&nbsp;&mdash; an&nbsp;appropriate name if&nbsp;jail. Thus, the terminal
these messages will not.
<br>
<b><i>/path/to/file</i></b>&nbsp;&mdash; Path to&nbsp;alternate file. For example, with <b>/dev/null</b>, the jail will not show anything and it&nbsp;will not record.
</body>
</html>